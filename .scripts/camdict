#!/bin/bash

MACMILLAN_DICT_URL="https://www.macmillandictionary.com/us/dictionary/american"
OXFORD_DICT_URL="https://www.lexico.com/en/definition"
CAMBRIDGE_DICT_URL="https://dictionary.cambridge.org/dictionary/english"

die() {
  echo "$@"; exit 1
}

usage() {
  cat <<EOF
Usage:
  camdict [-h|--help] [word]

Options:
  -h,--help     display this help
  word          which word to search, by default, search from primary
EOF
}

# Main
while (( ${#@} > 0 )); do
  case "$1" in
    -h|--help   ) usage; exit 0 ;;
    --debug     ) debug=true ;;
    *           ) [[ -z $word ]] && word=${1,,} || die "Only support one word at a time" ;;
  esac
  shift
done

if [[ -z $word ]]; then
  word=$(xclip -r -o -selection primary | tr '[:upper:]' '[:lower:]')
  if [[ -z $word ]]; then
    die "No words to find"
  fi
fi

qutebrowser --target tab "$MACMILLAN_DICT_URL/$word" &> /dev/null &
